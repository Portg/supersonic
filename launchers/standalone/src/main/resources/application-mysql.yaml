spring:
  datasource:
    driver-class-name: com.mysql.cj.jdbc.Driver
    url: jdbc:mysql://${S2_DB_HOST:localhost}:${S2_DB_PORT:3306}/${S2_DB_DATABASE:mysql}?useUnicode=true&characterEncoding=UTF-8&useSSL=false&allowMultiQueries=true&allowPublicKeyRetrieval=true
    username: ${S2_DB_USER:root}
    password: ${S2_DB_PASSWORD:}
  sql:
    init:
      continue-on-error: true
      mode: never
      username: ${S2_DB_USER:root}
      password: ${S2_DB_PASSWORD:}
      schema-locations: classpath:db/schema-mysql.sql,classpath:db/schema-mysql-demo.sql
      data-locations: classpath:db/data-mysql.sql,classpath:db/data-mysql-demo.sql
  flyway:
    enabled: true
    # 对于已有数据库，设置为 true 跳过已执行的迁移
    baseline-on-migrate: true
    # 基线版本：已有数据库从此版本开始
    # 新部署设置为 -1（执行所有迁移），已有数据库设置为实际版本
    baseline-version: ${FLYWAY_BASELINE_VERSION:-1}
    locations: classpath:db/migration/mysql
    table: flyway_schema_history
    # 允许乱序执行（用于修复脚本）
    out-of-order: false
    # 验证迁移脚本
    validate-on-migrate: true