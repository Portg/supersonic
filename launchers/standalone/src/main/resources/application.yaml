server:
  port: 9080
  compression:
    enabled: true
    min-response-size: 1024
    mime-types: application/javascript,application/json,application/xml,text/html,text/xml,text/plain,text/css,image/*

spring:
  profiles:
    active: ${S2_DB_TYPE:h2}
  application:
    name: chat
  config:
    import:
      - classpath:s2-config.yaml
  main:
    allow-circular-references: true
  mvc:
    pathmatch:
      matching-strategy: ANT_PATH_MATCHER
mybatis:
  mapper-locations=classpath:mappers/custom/*.xml,classpath*:/mappers/*.xml

logging:
  level:
    dev.langchain4j: DEBUG
    dev.ai4j.openai4j: DEBUG

springdoc:
  swagger-ui:
    path: /swagger-ui.html
    tags-sorter: alpha
    operations-sorter: alpha
  api-docs:
    path: /v3/api-docs
  group-configs:
    - group: 'default'
      paths-to-match: '/**'
  packages-to-scan: com.tencent.supersonic
  paths-to-match: /api/chat/**,/api/semantic/**

knife4j:
  enable: true
  openapi:
    title: 'SuperSonic API Documentation'
    description: 'SuperSonic API Documentation'
    version: v1.0
  setting:
    language: zh-CN
#  basic:
#    enable: true
#    username: test
#    password: 123456#
  documents:
    default:
      title: ChatBI API Documents
      description: ChatBI API Documents

# SuperSonic configuration
s2:
  # Permission configuration
  permission:
    sensitive:
      # Whether MID sensitive level requires authorization (default: false)
      # If true, MID level fields will be treated like HIGH level
      mid-level-require-auth: false
      # Whether to log access to MID sensitive level fields (default: true)
      log-mid-level-access: true
  # Multi-tenant configuration
  tenant:
    enabled: true
    required: false
    default-tenant-id: 1
    header-enabled: true
    tenant-id-header: X-Tenant-Id
    subdomain-enabled: false
    excluded-tables:
      # Global system tables (no tenant isolation needed)
      - s2_tenant
      - s2_subscription_plan
      - s2_system_config
      - s2_oauth_provider
      - s2_oauth_state
      - s2_auth_groups
      # RBAC tables (permissions are global, roles can be tenant-specific)
      - s2_permission
      - s2_role_permission
      # Tables that achieve tenant isolation through foreign key relationships
      # Chat related (via chat_id -> s2_chat or agent_id -> s2_agent)
      - s2_chat_query
      - s2_chat_statistics
      - s2_chat_memory
      - s2_chat_config
      - s2_chat_context
      - s2_chat_parse
      - s2_plugin
      # Model/Domain related (via model_id -> s2_model or domain_id -> s2_domain)
      - s2_dimension
      - s2_metric
      - s2_model_rela
      - s2_tag
      - s2_tag_object
      - s2_query_rule
      - s2_term
      - s2_canvas
      - s2_query_stat_info
      - s2_dictionary_conf
      - s2_dictionary_task
      - s2_available_date_info
      - s2_collect
      - s2_metric_query_default_config
      # User related (via user_id -> s2_user)
      - s2_oauth_token
      - s2_refresh_token
      - s2_user_session
      - s2_user_token
      - s2_app
    excluded-paths:
      # Pre-authentication endpoints (no tenant context available yet)
      - /api/auth/user/login
      - /api/auth/user/register
      - /api/auth/oauth/**
      - /api/auth/token/**
      # Admin endpoints (cross-tenant operations)
      - /api/auth/admin/**
      - /api/admin/tenant/**
      # Public endpoints
      - /api/public/**
      # Health and monitoring
      - /health
      - /actuator/**